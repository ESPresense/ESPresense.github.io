import { R as B } from "./rom-7bab3197.js";
const D = 1074521556, _ = "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", h = 1074520064, Q = "GOv8P9TnC0Bt6AtA7+wLQOnoC0CL6AtA6egLQEXpC0AC6gtAdOoLQB3qC0B95wtAn+kLQPTpC0Bj6QtAluoLQIrpC0CW6gtAWegLQK/oC0Dp6AtARekLQHPoC0BI6wtAr+wLQKHmC0DT7AtAoeYLQKHmC0Ch5gtAoeYLQKHmC0Ch5gtAoeYLQKHmC0Dv6gtAoeYLQMnrC0Cv7AtA", a = 1073605544, s = {
  entry: D,
  text: _,
  text_start: h,
  data: Q,
  data_start: a
};
class p extends B {
  constructor() {
    super(...arguments), this.CHIP_NAME = "ESP32", this.IMAGE_CHIP_ID = 0, this.EFUSE_RD_REG_BASE = 1073061888, this.DR_REG_SYSCON_BASE = 1073111040, this.UART_CLKDIV_REG = 1072955412, this.UART_CLKDIV_MASK = 1048575, this.UART_DATE_REG_ADDR = 1610612856, this.XTAL_CLK_DIVIDER = 1, this.FLASH_SIZES = {
      "1MB": 0,
      "2MB": 16,
      "4MB": 32,
      "8MB": 48,
      "16MB": 64
    }, this.FLASH_WRITE_SIZE = 1024, this.BOOTLOADER_FLASH_OFFSET = 4096, this.SPI_REG_BASE = 1072963584, this.SPI_USR_OFFS = 28, this.SPI_USR1_OFFS = 32, this.SPI_USR2_OFFS = 36, this.SPI_W0_OFFS = 128, this.SPI_MOSI_DLEN_OFFS = 40, this.SPI_MISO_DLEN_OFFS = 44, this.TEXT_START = s.text_start, this.ENTRY = s.entry, this.DATA_START = s.data_start, this.ROM_DATA = s.data, this.ROM_TEXT = s.text;
  }
  async read_efuse(g, A) {
    const C = this.EFUSE_RD_REG_BASE + 4 * A;
    return g.debug("Read efuse " + C), await g.read_reg(C);
  }
  async get_pkg_version(g) {
    const A = await this.read_efuse(g, 3);
    let C = A >> 9 & 7;
    return C += (A >> 2 & 1) << 3, C;
  }
  async get_chip_revision(g) {
    const A = await this.read_efuse(g, 3), C = await this.read_efuse(g, 5), t = await g.read_reg(this.DR_REG_SYSCON_BASE + 124), i = A >> 15 & 1, I = C >> 20 & 1, E = t >> 31 & 1;
    return i != 0 ? I != 0 ? E != 0 ? 3 : 2 : 1 : 0;
  }
  async get_chip_description(g) {
    const A = [
      "ESP32-D0WDQ6",
      "ESP32-D0WD",
      "ESP32-D2WD",
      "",
      "ESP32-U4WDH",
      "ESP32-PICO-D4",
      "ESP32-PICO-V3-02"
    ];
    let C = "";
    const t = await this.get_pkg_version(g), i = await this.get_chip_revision(g), I = i == 3;
    return (await this.read_efuse(g, 3) & 1 << 0) != 0 && (A[0] = "ESP32-S0WDQ6", A[1] = "ESP32-S0WD"), I && (A[5] = "ESP32-PICO-V3"), t >= 0 && t <= 6 ? C = A[t] : C = "Unknown ESP32", I && (t === 0 || t === 1) && (C += "-V3"), C + " (revision " + i + ")";
  }
  async get_chip_features(g) {
    const A = ["Wi-Fi"], C = await this.read_efuse(g, 3);
    (C & 1 << 1) === 0 && A.push(" BT"), (C & 1 << 0) !== 0 ? A.push(" Single Core") : A.push(" Dual Core"), (C & 1 << 13) !== 0 && ((C & 4096) !== 0 ? A.push(" 160MHz") : A.push(" 240MHz"));
    const E = await this.get_pkg_version(g);
    [2, 4, 5, 6].indexOf(E) !== -1 && A.push(" Embedded Flash"), E === 6 && A.push(" Embedded PSRAM"), (await this.read_efuse(g, 4) >> 8 & 31) !== 0 && A.push(" VRef calibration in efuse"), (C >> 14 & 1) !== 0 && A.push(" BLK3 partially reserved");
    const o = await this.read_efuse(g, 6) & 3, e = ["None", "3/4", "Repeat (UNSUPPORTED)", "Invalid"];
    return A.push(" Coding Scheme " + e[o]), A;
  }
  async get_crystal_freq(g) {
    const A = await g.read_reg(this.UART_CLKDIV_REG) & this.UART_CLKDIV_MASK, C = g.transport.baudrate * A / 1e6 / this.XTAL_CLK_DIVIDER;
    let t;
    return C > 33 ? t = 40 : t = 26, Math.abs(t - C) > 1 && g.info("WARNING: Unsupported crystal in use"), t;
  }
  _d2h(g) {
    const A = (+g).toString(16);
    return A.length === 1 ? "0" + A : A;
  }
  async read_mac(g) {
    let A = await this.read_efuse(g, 1);
    A = A >>> 0;
    let C = await this.read_efuse(g, 2);
    C = C >>> 0;
    const t = new Uint8Array(6);
    return t[0] = C >> 8 & 255, t[1] = C & 255, t[2] = A >> 24 & 255, t[3] = A >> 16 & 255, t[4] = A >> 8 & 255, t[5] = A & 255, this._d2h(t[0]) + ":" + this._d2h(t[1]) + ":" + this._d2h(t[2]) + ":" + this._d2h(t[3]) + ":" + this._d2h(t[4]) + ":" + this._d2h(t[5]);
  }
}
export {
  p as ESP32ROM
};
